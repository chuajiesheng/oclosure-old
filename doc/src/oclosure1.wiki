<<webonly |
  <<div id="oclosure_menu" dir="rtl">>
  <<script src="oclosure_menu_full.js">>
  <<script src="oclosure_menu.js">>
>>

=OClosure Library=

|<<webonly |{{oclosure_logo.png|OClosure logo}}>>|**OClosure library** is a binding of the [[http://code.google.com/closure/library/|Google Closure Javascript library]] in OCaml using [[../js_of_ocaml|Js_of_ocaml]].\\\\ You can now write dynamic user interfaces for web pages in OCaml.\\\\ You should find your way in the hundreds of class types if you take a look at the [[doc/overview|documentation]] pages but you might appreciate the [[http://closure-library.googlecode.com/svn/docs/index.html|Google Closure documentation]].|
----
To compile the library, you need:
* [[wiki(30):|Js_of_ocaml]] : generate Javascript code from OCaml bytecode

== Hello world ==
1. First, write an OCaml program using OClosure objects:
<<code language="ocaml"|open Js

let ccs s = Goog.Ui.ControlContent.string (Js.string s)

let get_element_by_id s = Js.Opt.get 
    (Dom_html.document##getElementById(Js.string s))
    (fun _ -> assert false)

let my_alert s = 
  let dialog = jsnew Goog.Ui.dialog(Js.null, Js.null, Js.null) in
  dialog##setContent(Js.string s);
  dialog##setVisible(Js._true)

let button = jsnew Goog.Ui.button(ccs "Click", Js.null, Js.null)

let _ = Goog.Events.listen 
    (Goog.Tools.Union.i1 button)
    (Js.string "action")
    (Js.wrap_callback (fun () -> my_alert "Hello world!"))
    Js.null
let _ = button##render(Js.some (get_element_by_id "button"))
>>

2.  Compile it with OCaml, Js_of_ocaml and Oclosure to obtain an byte code file, compile it with Js_of_ocaml to obtain a ##.js## file and apply the ##requirements.ml## script:
{{{
ocamlfind ocamlc  -I ../goog oclosure.cma -package js_of_ocaml -syntax camlp4o -linkpkg -o test.byte test.ml
js_of_ocaml test.byte -pretty
ocaml str.cma ../scripts/requirements.ml test.js
}}}

3. You will obtain a ##.js## and a ##_req.js## file. You are ready to write your web page:
{{{
<html>
  <head>
    <script src="http://closure-library.googlecode.com/svn/trunk/closure/goog/base.js"></script>
    <link rel="stylesheet" href="../static/css/common.css">
    <link rel="stylesheet" href="../static/css/dialog.css">
  </head>
<body>
<div id="button"></div>
</body>
<script src="test_req.js"></script>
<script src="test.js"></script>
</html>
}}}
